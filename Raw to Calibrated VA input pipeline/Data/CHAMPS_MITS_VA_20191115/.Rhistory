IV4neonate <- setcolorder(IV4data.neonatal.subset, names(RandomVA1))
IV4child <- setcolorder(IV4data.child.subset, names(RandomVA1))
# RUN 2012 MODELS
set.seed(123)
InterVA4_neonate <- codeVA(data = IV4neonate, data.type = "WHO2012", model = "InterVA",
version = "4.02", HIV = "h", Malaria = "h")
set.seed(123)
Insilico2012_neonate <- codeVA(data = IV4neonate, data.type = "WHO2012", model = "InSilicoVA",
Nsim=10000, version = "4.02", HIV = "h", Malaria = "h")
set.seed(123)
InterVA4_child <- codeVA(data = IV4child, data.type = "WHO2012", model = "InterVA",
version = "4.02", HIV = "h", Malaria = "h")
set.seed(123)
Insilico2012_child <- codeVA(data = IV4child, data.type = "WHO2012", model = "InSilicoVA",
Nsim=10000, version = "4.02", HIV = "h", Malaria = "h")
}
############################################# run InterVA5 for 2016 cases with MITS
# CHAMPSdata <- read_dta("/Users/EWilson/Desktop/COMSA/CHAMPS-Mozambique/December20,2018/champs_mits_va/dst_57_mits_va/mits_decode_va2016.dta")
# write.csv(CHAMPSdata, "/Users/EWilson/Desktop/COMSA/CHAMPS-Mozambique/December20,2018/champs_mits_va/dst_57_mits_va/mits_decode_va2016.csv")
CHAMPSdata <- read.csv("~/Desktop/COMSA/CHAMPS-Mozambique/June28,2019/CHAMPS_MITS_VA_20190628/asr_87_va2016.csv", header=TRUE, stringsAsFactors = FALSE)
MITS.CHILD <- read_excel("~/Desktop/COMSA/CHAMPS-Mozambique/June28,2019/CHAMPS_MITS_VA_20190628/CHAMPS-MITS - JUNE28 - FOR RECLASSIFICATION TO VA CATEGORIES(2).xlsx", sheet = "Child")
MITS.CHILD$champs_deid <- MITS.CHILD$champs_deid_2
MITS.CHILD <- MITS.CHILD[c("Name","champs_deid","VA COD (Initial revised/new case)")]
MITS.NEONATE <- read_excel("~/Desktop/COMSA/CHAMPS-Mozambique/June28,2019/CHAMPS_MITS_VA_20190628/CHAMPS-MITS - JUNE28 - FOR RECLASSIFICATION TO VA CATEGORIES(2).xlsx", sheet = "Neonates")
MITS.NEONATE$champs_deid <- MITS.NEONATE$champs_deid_2
MITS.NEONATE <- MITS.NEONATE[c("Name","champs_deid","VA COD (Initial revised/new case)")]
Child <- merge(MITS.CHILD,CHAMPSdata, by=c("champs_deid"))
Child$Group <- c("Child")
Neonate <- merge(MITS.NEONATE,CHAMPSdata, by=c("champs_deid"))
Neonate$Group <- c("Neonate")
dim(Child)   # 16 + 230 = 246 (45 cases don't match)
dim(Neonate) # 18 + 336 = 354 (71 cases don't match)
# test <- left_join(MITS.CHILD,CHAMPSdata, by=c("champs_deid"))
# test <- left_join(MITS.NEONATE,CHAMPSdata, by=c("champs_deid"))
# test1 <- subset(test, is.na(case_type_desc))
############################################# Look at new cases
CHAMPSdataNew <- read.csv("/Users/EWilson/Desktop/CHAMPS_MITS_VA_20191115/ASR-114_JHU_MITS_VA/asr_114_va2016.csv", header=TRUE, stringsAsFactors = FALSE)
MITS.New <- read.csv("/Users/EWilson/Desktop/CHAMPS_MITS_VA_20191115/ASR-114_JHU_MITS_VA/asr_114_decode_results_classification.csv", header=TRUE, stringsAsFactors = FALSE)
colnames(CHAMPSdataNew)
colnames(MITS.New)
dim(CHAMPSdataNew)
dim(MITS.New)
All.New <- merge(MITS.New,CHAMPSdataNew, by=c("champs_deid"))
table(All.New$case_type_desc)
unique(All.New$case_type_desc)
# Child = 128 (12 months to less than 60 Months) + 163 (28 days to less than 12 months) = 291
# Neonate = 155 (Death in the first 24 hours) + 157 (Early Neonate, 1 to 6 days) + 88 (Late Neonate, 7 to 27 days) = 400
Child.New <- subset(All.New, case_type_desc %in% c("Infant (28 days to less than 12 months)","Child (12 months to less than 60 Months)"))
Neonate.New <- subset(All.New, case_type_desc %in% c("Death in the first 24 hours","Early Neonate (1 to 6 days)","Late Neonate (7 to 27 days)"))
dim(Child.New)
dim(Neonate.New)
# look at whether original cases are still present; missing 2 child cases and 10 neonate cases
test.child <- merge(Child.New, Child, by=c("champs_deid"))
test.neonate <- merge(Neonate.New, Neonate, by=c("champs_deid"))
dim(test.child)
dim(test.neonate)
# make preliminary new case list for Henry to categorize
Child.New.ID <- as.data.frame(Child.New[,"champs_deid"])
names(Child.New.ID)[names(Child.New.ID) == 'Child.New[, "champs_deid"]'] <- 'champs_deid'
Neonate.New.ID <- as.data.frame(Neonate.New[,"champs_deid"])
names(Neonate.New.ID)[names(Neonate.New.ID) == 'Neonate.New[, "champs_deid"]'] <- 'champs_deid'
Child.MITS.New  <- merge(Child.New.ID,MITS.New,c("champs_deid"))
Neonate.MITS.New <- merge(Neonate.New.ID,MITS.New,c("champs_deid"))
Child.MITS.New_only <- anti_join(Child.MITS.New, Child, by=c("champs_deid")) # 63 new, plus 230 from before, minus 2 in before only = 291
dim(Child.MITS.New_only)
dim(Child)
Neonate.MITS.New_only <- anti_join(Neonate.MITS.New, Neonate, by=c("champs_deid")) # 74 new, plus 336 from before, minus 10 in before only = 400
dim(Neonate.MITS.New_only)
dim(Neonate)
unique(Child.MITS.New_only$IC_champs_group_desc)
unique(Child.MITS.New_only$UC_champs_group_desc)
unique(Neonate.MITS.New_only$IC_champs_group_desc)
unique(Neonate.MITS.New_only$UC_champs_group_desc)
# write.csv(Child.MITS.New_only,"/Users/EWilson/Desktop/CHAMPS_MITS_VA_20191115/CHAMPS-MITS-CHILD - addtional cases 2019NOV15 - FOR RECLASSIFICATION TO VA CATEGORIES.csv",row.names = FALSE)
# write.csv(Neonate.MITS.New_only,"/Users/EWilson/Desktop/CHAMPS_MITS_VA_20191115/CHAMPS-MITS-NEONATE - addtional cases 2019NOV15 - FOR RECLASSIFICATION TO VA CATEGORIES.csv",row.names = FALSE)
#############################################
# CHAMPSdata <- rbind(Child,Neonate)
CHAMPSdata <- CHAMPSdataNew
dim(CHAMPSdata)
class(CHAMPSdata$champs_deid)
names(CHAMPSdata) <- tolower(colnames(CHAMPSdata))
CHAMPSvariables <- as.vector(colnames(CHAMPSdata))
map <- read_xlsx("/Users/EWilson/Desktop/COMSA/Mapping/InterVA-5 excel with COMSA.xlsx")
y.n <- as.vector(na.omit(map$who_2016))
WHOvariables <- as.vector(na.omit(map$who_2016))
iv5variables <- as.vector(na.omit(map$iv5_indic))
CHAMPSonly <- setdiff(CHAMPSvariables, WHOvariables) # match these back to variables
WHOonly <- setdiff(WHOvariables,CHAMPSvariables) # match these back to variables
CHAMPSonly
WHOonly
################################## Map Columns
###### Wet/Dry
table(CHAMPSdata$id10004, exclude=NULL)
CHAMPSdata$id10004a[CHAMPSdata$id10004 == "wet"] <- "Y"
CHAMPSdata$id10004a[CHAMPSdata$id10004 == "WET SEASON"] <- "Y"
CHAMPSdata$id10004a[CHAMPSdata$id10004 == "dry"] <- "N"
CHAMPSdata$id10004b[CHAMPSdata$id10004 == "wet"] <- "N"
CHAMPSdata$id10004b[CHAMPSdata$id10004 == "dry"] <- "Y"
CHAMPSdata$id10004b[CHAMPSdata$id10004 == "DRY SEASON"] <- "Y"
###### Male/Female
table(CHAMPSdata$id10019, exclude=NULL)
CHAMPSdata$id10019a[CHAMPSdata$id10019  == "male"] <- "Y"
CHAMPSdata$id10019a[CHAMPSdata$id10019  == "MALE"] <- "Y"
CHAMPSdata$id10019a[CHAMPSdata$id10019  == "female"] <- "N"
CHAMPSdata$id10019b[CHAMPSdata$id10019  == "male"] <- "N"
CHAMPSdata$id10019b[CHAMPSdata$id10019  == "female"] <- "Y"
CHAMPSdata$id10019b[CHAMPSdata$id10019  == "FEMALE"] <- "Y"
###### Age
table(CHAMPSdata$id10022, exclude=NULL)
table(CHAMPSdata$ageindays, exclude=NULL)
table(CHAMPSdata$ageinmonths, exclude = NULL)
sum(table(CHAMPSdata$ageinyears))
table(CHAMPSdata$isneonatal, CHAMPSdata$age_group, exclude=NULL)
table(CHAMPSdata$age_neonate_minutes, CHAMPSdata$ageinmonths, exclude=NULL)
table(CHAMPSdata$age_neonate_days, CHAMPSdata$ageinmonths, exclude=NULL)
table(CHAMPSdata$age_neonate_hours)
table(CHAMPSdata$age_child_months)
table(CHAMPSdata$age_child_years)
table(CHAMPSdata$age_adult)
table(CHAMPSdata$age_adult, CHAMPSdata$id10022, exclude = NULL)
# revised age group based on WHO 2016 format
CHAMPSdata$ageatdeath <- NULL
CHAMPSdata$ageatdeath <- CHAMPSdata$ageindays
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_neonate_minutes) & !is.na(isneonatal), age_neonate_minutes/(60*24), ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_neonate_hours) & !is.na(isneonatal), age_neonate_hours/(24), ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_neonate_days) & !is.na(isneonatal), age_neonate_days, ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_child_months) & !is.na(ischild), age_child_months*30.4, ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_child_years) & !is.na(ischild), age_child_years*365.25, ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(age_adult) & !is.na(isadult), age_adult*365.25, ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(ageinyears) & !is.na(isadult), ageinyears*365.25, ageatdeath))
CHAMPSdata <- CHAMPSdata %>% mutate( ageatdeath = ifelse(is.na(ageatdeath) & !is.na(ageinmonths) & !is.na(isadult), ageinmonths*30.4, ageatdeath))
table(is.na(CHAMPSdata$ageatdeath))
CHAMPSdata$id10022a <- ifelse(CHAMPSdata$ageatdeath  >= 65*365.25, "Y", "N")
CHAMPSdata$id10022b <- ifelse(CHAMPSdata$ageatdeath >= 50*365.25 & CHAMPSdata$ageatdeath < 65*365.25, "Y","N")
CHAMPSdata$id10022c <- ifelse(CHAMPSdata$ageatdeath >= 15*365.25 & CHAMPSdata$ageatdeath < 50*365.25, "Y", "N")
CHAMPSdata$id10022d <- ifelse(CHAMPSdata$ageatdeath >= 5*365.25 & CHAMPSdata$ageatdeath < 15*365.25, "Y", "N")
CHAMPSdata$id10022e <- ifelse(CHAMPSdata$ageatdeath >= 1*365.25 & CHAMPSdata$ageatdeath < 5*365.25, "Y", "N")
CHAMPSdata$id10022f <- ifelse(CHAMPSdata$ageatdeath >= 28 & CHAMPSdata$ageatdeath < 365.25, "Y", "N")
CHAMPSdata$id10022g <- ifelse(CHAMPSdata$ageatdeath < 28, "Y", "N")
CHAMPSdata$id10022h <- ifelse(CHAMPSdata$ageatdeath < 1, "Y", "N")
CHAMPSdata$id10022i <- ifelse(CHAMPSdata$ageatdeath %in% c(1:2), "Y", "N")
CHAMPSdata$id10022j <- ifelse(CHAMPSdata$ageatdeath %in% c(3:7), "Y", "N")
CHAMPSdata$id10022k <- ifelse(CHAMPSdata$ageatdeath %in% c(8:27), "Y", "N")
CHAMPSdata$id10022l <- ifelse(CHAMPSdata$id10019b == "Y" & CHAMPSdata$ageatdeath >= 12*365.25 & CHAMPSdata$ageatdeath < 20*365.25, "Y", "N")
CHAMPSdata$id10022m <- ifelse(CHAMPSdata$id10019b == "Y" & CHAMPSdata$ageatdeath >= 20*365.25 & CHAMPSdata$ageatdeath < 35*365.25, "Y", "N")
CHAMPSdata$id10022n <- ifelse(CHAMPSdata$id10019b == "Y" & CHAMPSdata$ageatdeath >= 35*365.25 & CHAMPSdata$ageatdeath < 49*365.25, "Y", "N")
###### Women
table(CHAMPSdata$id10059, exclude=NULL)
# CHAMPSdata$id10059o <- ifelse(CHAMPSdata$id10059 %in% c("married","partner"), "Y", ".")
CHAMPSdata$id10059o <- "."
table(CHAMPSdata$id10106, exclude=NULL)
CHAMPSdata$id10106a <- ifelse(CHAMPSdata$id10106 %in% c(6:98), "Y",ifelse(CHAMPSdata$id10106 == "NULL",".","N"))
table(CHAMPSdata$id10106,CHAMPSdata$id10106a)
table(CHAMPSdata$id10108, exclude=NULL)
CHAMPSdata$id10108a <- ifelse(CHAMPSdata$id10108 %in% c(1:98), "Y",ifelse(CHAMPSdata$id10108 %in% c("NULL",99,9999),".","N"))
table(CHAMPSdata$id10108,CHAMPSdata$id10108a, exclude=NULL)
# CHAMPSdata$id10120a <- ifelse(CHAMPSdata$illdur < 21, "Y", ".")
# CHAMPSdata$id10120b <- ifelse(CHAMPSdata$illdur >=21 , "Y", ".")
table(CHAMPSdata$illness_length)
table(CHAMPSdata$id10120_unit)
table(CHAMPSdata$id10120_unit, CHAMPSdata$id10120)
table(CHAMPSdata$id10120_unit, CHAMPSdata$id10121)
table(CHAMPSdata$id10120_unit, CHAMPSdata$id10122)
table(CHAMPSdata$illness_length, CHAMPSdata$id10120)
table(CHAMPSdata$id10120)  # Days
table(CHAMPSdata$illness_length, CHAMPSdata$id10121)
table(CHAMPSdata$id10121)  # Months
table(CHAMPSdata$illness_length, CHAMPSdata$id10122)
table(CHAMPSdata$id10122)  # Weeks
CHAMPSdata$id10120a <- ifelse(CHAMPSdata$id10120_unit=="days" & CHAMPSdata$id10120 < 21, "Y",ifelse(CHAMPSdata$id10120 %in% c("NULL",99,9999),".","N"))
CHAMPSdata$id10120b <- ifelse(CHAMPSdata$id10120_unit=="days" & CHAMPSdata$id10120 >= 21 |
CHAMPSdata$id10120_unit %in% c("months","years"), "Y",ifelse(CHAMPSdata$id10120 %in% c("NULL",99,9999),".","N"))
# CHAMPSdata$id10120c <- ifelse(CHAMPSdata$id10120 >=21 | CHAMPSdata$id10122 >= 3 | CHAMPSdata$id10122>= 1, "Y", ".")
table(CHAMPSdata$id10120a)
table(CHAMPSdata$id10120, CHAMPSdata$id10120b)
# table(CHAMPSdata$id10120c)
table(CHAMPSdata$id10148)
CHAMPSdata$id10148a <- ifelse(CHAMPSdata$id10148 <7, "Y",ifelse(CHAMPSdata$id10148 %in% c("NULL",99,9999),".","N"))
CHAMPSdata$id10148b <- ifelse(CHAMPSdata$id10148 %in% c(7:13), "Y",ifelse(CHAMPSdata$id10148 %in% c("NULL",99,9999),".","N"))
CHAMPSdata$id10148c <- ifelse(CHAMPSdata$id10148 >=14 & CHAMPSdata$id10148 < 99, "Y",ifelse(CHAMPSdata$id10148 %in% c("NULL",99,9999),".","N"))
table(CHAMPSdata$id10148a)
table(CHAMPSdata$id10148b)
table(CHAMPSdata$id10148c)
table(CHAMPSdata$id10150)
CHAMPSdata$id10150a <- ifelse(CHAMPSdata$id10150 %in% c("severe"), "Y",ifelse(CHAMPSdata$id10150 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10150, CHAMPSdata$id10150a)
table(CHAMPSdata$id10151)
CHAMPSdata$id10151a <- ifelse(CHAMPSdata$id10151 %in% c("continuous"), "Y",ifelse(CHAMPSdata$id10151 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10151, CHAMPSdata$id10151a)
table(CHAMPSdata$id10154)
CHAMPSdata$id10154a <- ifelse(CHAMPSdata$id10154 < 21, "Y",ifelse(CHAMPSdata$id10154 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10154b <- ifelse(CHAMPSdata$id10154 >= 21 & CHAMPSdata$id10154 != "NULL", "Y",ifelse(CHAMPSdata$id10154 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10154, CHAMPSdata$id10154b)
table(CHAMPSdata$id10161)
CHAMPSdata$id10161a <- ifelse(CHAMPSdata$id10161 >= 3 & CHAMPSdata$id10161 != "NULL" , "Y",ifelse(CHAMPSdata$id10161 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10161, CHAMPSdata$id10161a)
table(CHAMPSdata$id10165)
CHAMPSdata$id10165a <- ifelse(CHAMPSdata$id10165 %in% c("continuous"), "Y",ifelse(CHAMPSdata$id10165 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10165, CHAMPSdata$id10165a)
table(CHAMPSdata$id10167)
CHAMPSdata$id10167a <- ifelse(CHAMPSdata$id10167 < 14, "Y",ifelse(CHAMPSdata$id10167 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10167b <- ifelse(CHAMPSdata$id10167 >= 14 & CHAMPSdata$id10167 != "NULL", "Y",ifelse(CHAMPSdata$id10167 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10167, CHAMPSdata$id10167b)
table(CHAMPSdata$id10169)
CHAMPSdata$id10169a <- ifelse(CHAMPSdata$id10169 < 14, "Y",ifelse(CHAMPSdata$id10169 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10169b <- ifelse(CHAMPSdata$id10169 >= 14 & CHAMPSdata$id10167 != "NULL", "Y",ifelse(CHAMPSdata$id10167 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10169, CHAMPSdata$id10169b)
table(CHAMPSdata$id10173)
CHAMPSdata$id10173a <- ifelse(CHAMPSdata$id10173 %in% c("grunting","grunting dk","grunting wheezing","stridor grunting","stridor grunting wheezing","stridor wheezing","wheezing"), "Y",ifelse(CHAMPSdata$id10173 %in% c("NULL","dk"),".","N"))
table(CHAMPSdata$id10173,CHAMPSdata$id10173a)
table(CHAMPSdata$id10176)
CHAMPSdata$id10176a <- ifelse(CHAMPSdata$id10176 >= 3 & CHAMPSdata$id10176 != 99 & CHAMPSdata$id10176 != "NULL", "Y",ifelse(CHAMPSdata$id10176 %in% c("NULL","dk"),".","N"))
table(CHAMPSdata$id10176, CHAMPSdata$id10176a )
table(CHAMPSdata$id10178)
CHAMPSdata$id10178a <- ifelse(CHAMPSdata$id10178 >= 30 & CHAMPSdata$id10178 != "NULL", "Y",ifelse(CHAMPSdata$id10178 %in% c("NULL","dk"),".","N"))
table(CHAMPSdata$id10178,CHAMPSdata$id10178a)
table(CHAMPSdata$id10182)
CHAMPSdata$id10182a <- ifelse(CHAMPSdata$id10182 < 14, "Y",ifelse(CHAMPSdata$id10182 %in% c(99,"NULL"),".","N"))
CHAMPSdata$id10182b <- ifelse(CHAMPSdata$id10182 %in% c(14:27), "Y",ifelse(CHAMPSdata$id10182 %in% c(99,"NULL"),".","N"))
CHAMPSdata$id10182c <- ifelse(CHAMPSdata$id10182 >=28 & CHAMPSdata$id10182 != 99 & CHAMPSdata$id10182 != "NULL", "Y", ifelse(CHAMPSdata$id10182 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10182, CHAMPSdata$id10182a)
table(CHAMPSdata$id10182, CHAMPSdata$id10182b)
table(CHAMPSdata$id10182, CHAMPSdata$id10182c)
table(CHAMPSdata$id10183)
CHAMPSdata$id10183a <- ifelse(CHAMPSdata$id10183 >= 4 & CHAMPSdata$id10183 < 99, "Y",ifelse(CHAMPSdata$id10183 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10183, CHAMPSdata$id10183a)
table(CHAMPSdata$id10184)
CHAMPSdata$id10184a <- ifelse(CHAMPSdata$id10184 >= 3 & CHAMPSdata$id10184 < 99, "Y",ifelse(CHAMPSdata$id10184 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10184, CHAMPSdata$id10184a)
table(CHAMPSdata$id10190)
CHAMPSdata$id10190o <- ifelse(CHAMPSdata$id10190 >= 3 & CHAMPSdata$id10190 < 99, "Y",ifelse(CHAMPSdata$id10190 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10190, CHAMPSdata$id10190o)
# CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10196),0,".")
# CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10197),CHAMPSdata$a_pain_how_long,CHAMPSdata$paindur)
# CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10197b),7*CHAMPSdata$a_pain_how_long,CHAMPSdata$paindur)
# CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10198),30*CHAMPSdata$a_pain_how_long,CHAMPSdata$paindur)
# CHAMPSdata$paindur <- as.numeric(as.character(CHAMPSdata$paindur))
#
# CHAMPSdata$id10197a <- ifelse(CHAMPSdata$paindur <14, "Y", ".")
# CHAMPSdata$id10197b <- ifelse(CHAMPSdata$paindur>=14 & CHAMPSdata$paindur<99, "Y", ".")
CHAMPSdata$pain_duration[CHAMPSdata$pain_duration=="DAYS"]<-"days"
table(CHAMPSdata$pain_duration, CHAMPSdata$id10196) # Hours
table(CHAMPSdata$pain_duration, CHAMPSdata$id10197) # Days
table(CHAMPSdata$pain_duration, CHAMPSdata$id10197b) # Weeks
table(CHAMPSdata$pain_duration, CHAMPSdata$id10198) # Months
CHAMPSdata$id10196 <- as.numeric(CHAMPSdata$id10196)
CHAMPSdata$id10197 <- as.numeric(CHAMPSdata$id10197)
CHAMPSdata$id10197b <- as.numeric(CHAMPSdata$id10197b)
CHAMPSdata$id10198 <- as.numeric(CHAMPSdata$id10198)
CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10196),0,".")
CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10197),CHAMPSdata$id10197,CHAMPSdata$paindur)
CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10197b),7*CHAMPSdata$id10197b,CHAMPSdata$paindur)
CHAMPSdata$paindur <- ifelse(!is.na(CHAMPSdata$id10198),30*CHAMPSdata$id10198,CHAMPSdata$paindur)
CHAMPSdata$paindur <- as.numeric(as.character(CHAMPSdata$paindur))
table(CHAMPSdata$paindur, exclude = NULL)
CHAMPSdata$id10197a <- ifelse(CHAMPSdata$paindur <14, "Y",ifelse(is.na(CHAMPSdata$paindur),".","N"))
CHAMPSdata$id10197b <- ifelse(CHAMPSdata$paindur>=14 & CHAMPSdata$paindur<99, "Y",ifelse(is.na(CHAMPSdata$paindur),".","N"))
table(CHAMPSdata$paindur,CHAMPSdata$id10197a, exclude=NULL)
table(CHAMPSdata$paindur,CHAMPSdata$id10197b, exclude=NULL)
table(CHAMPSdata$id10199, exclude = NULL)
CHAMPSdata$id10199a <- ifelse(CHAMPSdata$id10199 %in% c("upper_abdomen", "upper"), "Y",ifelse(CHAMPSdata$id10199 %in% c("DK","NULL"),".","N"))
CHAMPSdata$id10199b <- ifelse(CHAMPSdata$id10199 %in% c("lower_abdomen","upper_lower_abdomen"), "Y",ifelse(CHAMPSdata$id10199 %in% c("DK","NULL"),".","N"))
table(CHAMPSdata$id10199, CHAMPSdata$id10199a , exclude = NULL)
table(CHAMPSdata$id10199, CHAMPSdata$id10199b , exclude = NULL)
table(CHAMPSdata$id10201)
CHAMPSdata$id10201a <- ifelse(CHAMPSdata$id10201 < 14, "Y",ifelse(CHAMPSdata$id10201 %in% c(999,"NULL"),".","N"))
CHAMPSdata$id10201b <- ifelse(CHAMPSdata$id10201 >=14 & CHAMPSdata$id10201!="NULL", "Y",ifelse(CHAMPSdata$id10201 %in% c(999,"NULL"),".","N"))
table(CHAMPSdata$id10201, CHAMPSdata$id10201a)
table(CHAMPSdata$id10201, CHAMPSdata$id10201b)
table(CHAMPSdata$id10203)
CHAMPSdata$id10203a <- ifelse(CHAMPSdata$id10203 %in% c("rapidly"), "Y",ifelse(CHAMPSdata$id10203 %in% c("Ref","NULL"),".","N"))
table(CHAMPSdata$id10203, CHAMPSdata$id10203a)
CHAMPSdata$id10205 <- as.numeric(CHAMPSdata$id10205)
table(CHAMPSdata$id10205)
CHAMPSdata$id10205a <- ifelse(CHAMPSdata$id10205 < 14, "Y",ifelse(CHAMPSdata$id10205 %in% c("NULL"),".","N"))
CHAMPSdata$id10205b <- ifelse(CHAMPSdata$id10205 >=14 & CHAMPSdata$id10205 <99, "Y",ifelse(CHAMPSdata$id10205 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10205, CHAMPSdata$id10205a)
table(CHAMPSdata$id10205, CHAMPSdata$id10205b)
table(CHAMPSdata$id10209, exclude = NULL)
CHAMPSdata$id10209a <- ifelse(CHAMPSdata$id10209 < 7, "Y",ifelse(CHAMPSdata$id10209 %in% c("NULL"),".","N"))
CHAMPSdata$id10209b <- ifelse(CHAMPSdata$id10209 >=7 & CHAMPSdata$id10209 < 99, "Y",ifelse(CHAMPSdata$id10209 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10209, CHAMPSdata$id10209a)
table(CHAMPSdata$id10209, CHAMPSdata$id10209b)
table(CHAMPSdata$id10211, exclude = NULL)
CHAMPSdata$id10211a <- ifelse(CHAMPSdata$id10211 >= 7 & CHAMPSdata$id10211 != "NULL", "Y",ifelse(CHAMPSdata$id10211 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10211, CHAMPSdata$id10211a)
table(CHAMPSdata$id10213, exclude = NULL)
CHAMPSdata$id10213o <- ifelse(CHAMPSdata$id10213 >= 3 & CHAMPSdata$id10213 != "NULL", "Y",ifelse(CHAMPSdata$id10213 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10213, CHAMPSdata$id10213o)
CHAMPSdata$id10216 <- as.numeric(CHAMPSdata$id10216)
table(CHAMPSdata$id10216, exclude = NULL)
CHAMPSdata$id10216a <- ifelse(CHAMPSdata$id10216 > 6 & CHAMPSdata$id10216 != "NULL", "Y",ifelse(CHAMPSdata$id10216 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10216, CHAMPSdata$id10216a, exclude = NULL)
table(CHAMPSdata$id10221, exclude = NULL)
CHAMPSdata$id10221a <- ifelse(CHAMPSdata$id10221 < 10, "Y",ifelse(CHAMPSdata$id10221 %in% c("NULL"),".","N"))
CHAMPSdata$id10221b <- ifelse(CHAMPSdata$id10221 >=10 & CHAMPSdata$id10221 <99 , "Y",ifelse(CHAMPSdata$id10221 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10221, CHAMPSdata$id10221a, exclude = NULL)
table(CHAMPSdata$id10221, CHAMPSdata$id10221b, exclude = NULL)
table(CHAMPSdata$id10232, exclude = NULL)
CHAMPSdata$id10232a <- ifelse(CHAMPSdata$id10232 >= 14 & CHAMPSdata$id10232 != "NULL", "Y",ifelse(CHAMPSdata$id10232 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10232, CHAMPSdata$id10232a)
CHAMPSdata$id10234a <- ifelse(CHAMPSdata$id10234 < 7, "Y",ifelse(CHAMPSdata$id10234 %in% c("NULL"),".","N"))
CHAMPSdata$id10234b <- ifelse(CHAMPSdata$id10234 >=7 & CHAMPSdata$id10234 != "NULL", "Y",ifelse(CHAMPSdata$id10234 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10234,CHAMPSdata$id10234a)
table(CHAMPSdata$id10234,CHAMPSdata$id10234b)
table(CHAMPSdata$id10235, exclude=NULL)
CHAMPSdata$id10235a <- ifelse(CHAMPSdata$id10235 %in% c("face","face trunk","face trunk extremities"), "Y",ifelse(CHAMPSdata$id10235 %in% c("NULL"),".","N"))
CHAMPSdata$id10235b <- ifelse(CHAMPSdata$id10235 %in% c("face trunk","trunk","face trunk extremities","trunk extremities"), "Y",ifelse(CHAMPSdata$id10235 %in% c("NULL"),".","N"))
CHAMPSdata$id10235c <- ifelse(CHAMPSdata$id10235 %in% c("extremities","face trunk extremities","trunk extremities"), "Y",ifelse(CHAMPSdata$id10235 %in% c("NULL"),".","N"))
CHAMPSdata$id10235d <- ifelse(CHAMPSdata$id10235 %in% c("every","everywhere"), "Y", ".")
table(CHAMPSdata$id10235, CHAMPSdata$id10235a, exclude=NULL)
table(CHAMPSdata$id10235, CHAMPSdata$id10235b, exclude=NULL)
table(CHAMPSdata$id10235, CHAMPSdata$id10235c, exclude=NULL)
table(CHAMPSdata$id10248)
table(CHAMPSdata$id10248_a)
table(CHAMPSdata$id10248_b)
table(CHAMPSdata$id10248_units)
CHAMPSdata$id10248 <- as.numeric(CHAMPSdata$id10248)
CHAMPSdata$id10248a <- ifelse(CHAMPSdata$id10248 >= 7 & CHAMPSdata$id10248 < 99, "Y",ifelse(CHAMPSdata$id10248 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10248, CHAMPSdata$id10248a, exclude=NULL)
table(CHAMPSdata$id10250)
CHAMPSdata$id10250 <- as.numeric(CHAMPSdata$id10250)
CHAMPSdata$id10250a <- ifelse(CHAMPSdata$id10250 >= 3 & CHAMPSdata$id10250 <99, "Y",ifelse(CHAMPSdata$id10250 %in% c(99,"NULL"),".","N"))
table(CHAMPSdata$id10250, CHAMPSdata$id10250a, exclude = NULL)
table(CHAMPSdata$id10260)
CHAMPSdata$id10260a <- ifelse(CHAMPSdata$id10260 %in% c("right_side"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260b <- ifelse(CHAMPSdata$id10260 %in% c("left_side"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260c <- ifelse(CHAMPSdata$id10260 %in% c("lower_part_of_body"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260d <- ifelse(CHAMPSdata$id10260 %in% c("upper_part_of_body"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260e <- ifelse(CHAMPSdata$id10260 %in% c("one_leg_only"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260f <- ifelse(CHAMPSdata$id10260 %in% c("one_arm_only"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
CHAMPSdata$id10260g <- ifelse(CHAMPSdata$id10260 %in% c("whole_body"), "Y",ifelse(CHAMPSdata$id10260 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10260, CHAMPSdata$id10260a, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260b, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260c, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260d, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260e, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260f, exclude = NULL)
table(CHAMPSdata$id10260, CHAMPSdata$id10260g, exclude = NULL)
table(CHAMPSdata$id10262, exclude = NULL)
CHAMPSdata$id10262 <- as.numeric(CHAMPSdata$id10262)
CHAMPSdata$id10262a <- ifelse(CHAMPSdata$id10262 >=7 & CHAMPSdata$id10262 != "NULL", "Y",ifelse(CHAMPSdata$id10262 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10262,CHAMPSdata$id10262a, exclude = NULL)
table(CHAMPSdata$id10263)
CHAMPSdata$id10263a <- ifelse(CHAMPSdata$id10263 %in% c("solids","both"), "Y",ifelse(CHAMPSdata$id10263 %in% c("NULL"),".","N"))
CHAMPSdata$id10263b <- ifelse(CHAMPSdata$id10263 %in% c("liquids","both"), "Y",ifelse(CHAMPSdata$id10263 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10263,CHAMPSdata$id10263a)
table(CHAMPSdata$id10263,CHAMPSdata$id10263b)
CHAMPSdata$id10266_unit[CHAMPSdata$id10266_unit=="DAYS"] <- "days"
table(CHAMPSdata$id10266_units, CHAMPSdata$id10266)
table(CHAMPSdata$id10266_units, CHAMPSdata$id10266_a)
table(CHAMPSdata$id10266_units, CHAMPSdata$id10266_b)
CHAMPSdata$id10266 <- as.numeric(CHAMPSdata$id10266)
CHAMPSdata$id10266a <- ifelse(CHAMPSdata$id10266 >=21 | CHAMPSdata$id10266_a >=21 & CHAMPSdata$id10266!="NULL", "Y",ifelse(CHAMPSdata$id10266 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10266,CHAMPSdata$id10266a, exclude = NULL)
table(CHAMPSdata$id10274, exclude = NULL)
CHAMPSdata$id10274 <- as.numeric(CHAMPSdata$id10274)
CHAMPSdata$id10274a <- ifelse(CHAMPSdata$id10274 >=2 & CHAMPSdata$id10274 != 99, "Y",ifelse(CHAMPSdata$id10274 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10274,CHAMPSdata$id10274a, exclude = NULL)
table(CHAMPSdata$id10285, exclude = NULL)
CHAMPSdata$id10285 <- as.numeric(CHAMPSdata$id10285)
CHAMPSdata$id10285a <- ifelse(CHAMPSdata$id10285 >3 & CHAMPSdata$id10285 < 99, "Y",ifelse(CHAMPSdata$id10285 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10285,CHAMPSdata$id10285a, exclude = NULL)
table(CHAMPSdata$id10303, exclude = NULL)
CHAMPSdata$id10303 <- as.numeric(CHAMPSdata$id10303)
CHAMPSdata$id10303a <- ifelse(CHAMPSdata$id10303 >=4 & CHAMPSdata$id10303!="NULL", "Y",ifelse(CHAMPSdata$id10303 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10303,CHAMPSdata$id10303a, exclude = NULL)
table(CHAMPSdata$id10309, exclude=NULL)
CHAMPSdata$id10309o <- ifelse(CHAMPSdata$id10309 <6 & CHAMPSdata$id10309!="NULL", "Y",ifelse(CHAMPSdata$id10309 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10319)
CHAMPSdata$id10319a <- ifelse(CHAMPSdata$id10319 ==1 & CHAMPSdata$id10319!="NULL", "Y",ifelse(CHAMPSdata$id10319 %in% c("NULL"),".","N"))
CHAMPSdata$id10319b <- ifelse(CHAMPSdata$id10319 >=4 & CHAMPSdata$id10319!="NULL", "Y",ifelse(CHAMPSdata$id10319 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10332)
CHAMPSdata$id10332a <- ifelse(CHAMPSdata$id10332 >24 & CHAMPSdata$id10332 !="NULL", "Y",ifelse(CHAMPSdata$id10332 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10337)
CHAMPSdata$id10337a <- ifelse(CHAMPSdata$id10337 %in% c("hospital","other_health_facility"), "Y",ifelse(CHAMPSdata$id10337 %in% c("NULL"),".","N"))
CHAMPSdata$id10337b <- ifelse(CHAMPSdata$id10337 %in% c("home"), "Y",ifelse(CHAMPSdata$id10337 %in% c("NULL"),".","N"))
CHAMPSdata$id10337c <- ifelse(CHAMPSdata$id10337 %in% c("other"), "Y",ifelse(CHAMPSdata$id10337 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10355)
CHAMPSdata$id10355a <- ifelse(CHAMPSdata$id10355 %in% c("first"), "Y",ifelse(CHAMPSdata$id10355 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10355, CHAMPSdata$id10355a, exclude=NULL)
table(CHAMPSdata$id10357)
CHAMPSdata$id10357o <- ifelse(CHAMPSdata$id10357 %in% c("during_delivery","after_delivery"), "Y",ifelse(CHAMPSdata$id10357 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10357, CHAMPSdata$id10357o, exclude=NULL)
table(CHAMPSdata$id10358)
CHAMPSdata$id10358a <- ifelse(CHAMPSdata$id10358 <=12 & CHAMPSdata$id10358 != "NULL", "Y",ifelse(CHAMPSdata$id10358 %in% c("NULL"),".","N"))
table(CHAMPSdata$id10360)
CHAMPSdata$id10360a <- ifelse(CHAMPSdata$id10360 %in% c("HOSPITAL","hospital","other_health_facility"), "Y",ifelse(CHAMPSdata$id10360 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10360b <- ifelse(CHAMPSdata$id10360 %in% c("home"), "Y",ifelse(CHAMPSdata$id10360 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10360c <- ifelse(CHAMPSdata$id10360 %in% c("other","on_route_to_hospital_or_facility"), "Y",ifelse(CHAMPSdata$id10360 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10360, CHAMPSdata$id10360a, exclude = NULL)
table(CHAMPSdata$id10360, CHAMPSdata$id10360b, exclude = NULL)
table(CHAMPSdata$id10360, CHAMPSdata$id10360c, exclude = NULL)
table(CHAMPSdata$id10367)
CHAMPSdata$id10367 <- as.numeric(CHAMPSdata$id10367)
CHAMPSdata$id10367a <- ifelse(CHAMPSdata$id10367 >=9 & CHAMPSdata$id10367 <= 10, "Y",ifelse(CHAMPSdata$id10367 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10367b <- ifelse(CHAMPSdata$id10367 ==8, "Y",ifelse(CHAMPSdata$id10367 %in% c("NULL","DK"),".","N"))
CHAMPSdata$id10367c <- ifelse(CHAMPSdata$id10367 <=7, "Y",ifelse(CHAMPSdata$id10367 %in% c("NULL","DK"),".","N"))
table(CHAMPSdata$id10367, CHAMPSdata$id10367a, exclude = NULL)
table(CHAMPSdata$id10367, CHAMPSdata$id10367b, exclude = NULL)
table(CHAMPSdata$id10367, CHAMPSdata$id10367c, exclude = NULL)
table(CHAMPSdata$id10382)
CHAMPSdata$id10382 <- as.numeric(CHAMPSdata$id10382)
CHAMPSdata$id10382a <- ifelse(CHAMPSdata$id10382 >24 & CHAMPSdata$id10382<99, "Y",ifelse(CHAMPSdata$id10382 %in% c("NULL",99),".","N"))
table(CHAMPSdata$id10382, CHAMPSdata$id10382a)
table(CHAMPSdata$id10385)
CHAMPSdata$id10385a <- ifelse(CHAMPSdata$id10385 %in% c("green_or_brown"), "Y",ifelse(CHAMPSdata$id10385 %in% c("NULL","ref","dk"),".","N"))
table(CHAMPSdata$id10385,CHAMPSdata$id10385a)
table(CHAMPSdata$id10394)
CHAMPSdata$id10394a <- ifelse(CHAMPSdata$id10394 <=0, "Y",ifelse(CHAMPSdata$id10394 %in% c("NULL","ref","dk"),".","N"))
CHAMPSdata$id10394b <- ifelse(CHAMPSdata$id10394 >=4 & CHAMPSdata$id10394 != "NULL", "Y",ifelse(CHAMPSdata$id10394 %in% c("NULL","ref","dk"),".","N"))
table(CHAMPSdata$id10394,CHAMPSdata$id10394a, exclude = NULL)
table(CHAMPSdata$id10394,CHAMPSdata$id10394b, exclude = NULL)
table(CHAMPSdata$id10414)
CHAMPSdata$id10414a <- ifelse(CHAMPSdata$id10414 %in% c("chewing_tobacco"), "Y",ifelse(CHAMPSdata$id10414 %in% c("NULL","ref","dk"),".","N"))
table(CHAMPSdata$id10415)
CHAMPSdata$id10415a <- ifelse(CHAMPSdata$id10415 >=10 & CHAMPSdata$id10415 != "NULL", "Y",ifelse(CHAMPSdata$id10415 %in% c("NULL","ref","dk"),".","N"))
table(CHAMPSdata$id10415,CHAMPSdata$id10415a, exclude=NULL)
################################## CONVERT ALL Y/N INTO BINARY FORMAT AT ONCE
for(i in c(1:227,229:ncol(CHAMPSdata))){
CHAMPSdata[i][CHAMPSdata[i] == "NA"] <- "."
CHAMPSdata[i][CHAMPSdata[i] == "DK"] <- "."
CHAMPSdata[i][CHAMPSdata[i] == "dk"] <- "."
CHAMPSdata[i][CHAMPSdata[i] == "ref"] <- "."
CHAMPSdata[i][CHAMPSdata[i] == ""] <- "."
CHAMPSdata[i][is.na(CHAMPSdata[i])] <- "."
CHAMPSdata[i][CHAMPSdata[i] == "NULL"] <- "."
CHAMPSdata[i][CHAMPSdata[i] == "yes"] <- "Y"
CHAMPSdata[i][CHAMPSdata[i] == "YES"] <- "Y"
CHAMPSdata[i][CHAMPSdata[i] == "no"] <- "N"
CHAMPSdata[i][CHAMPSdata[i] == "NO"] <- "N"
}
names(CHAMPSdata)[names(CHAMPSdata) == 'champs_deid'] <- 'ID'
# record_f_name <- system.file("sample", "who151_va_output.csv", package = "CrossVA")
# records <- read.csv(record_f_name)
# # colnames(records)
# sample_test <- odk2openVA_v151(records)
# colnames(sample_test)
file <- getwd()
records <- read.csv(file.path(file,"who151_va_output.csv"))
sample_test <- odk2openVA_v151(records)
colnames(sample_test)
#############
test <- CHAMPSdata
names(test) <- sub("id10", "i", names(test))
COMSAonly <- setdiff(colnames(test), colnames(sample_test))
sampleonly <- setdiff(colnames(sample_test),colnames(test))
sampleonly <- sub("i", "id10", sampleonly)
sampleonly <- sub("o", "", sampleonly)
for(j in 1:ncol(CHAMPSdata)){
if(names(CHAMPSdata[j]) %in% sampleonly){
print(colnames(CHAMPSdata)[j])
store <- paste0(colnames(CHAMPSdata)[j],"o", sep="")
print(store)
names(CHAMPSdata)[names(CHAMPSdata) == colnames(CHAMPSdata)[j]] <- store
}
}
names(CHAMPSdata) <- sub("id10", "i", names(CHAMPSdata))
# IV5data.neonatal <- subset(CHAMPSdata, group=="Neonate")
IV5data.neonatal <- subset(CHAMPSdata, case_type_desc %in% c("Death in the first 24 hours","Early Neonate (1 to 6 days)","Late Neonate (7 to 27 days)"))
dim(IV5data.neonatal)
# IV5data.childu5 <- subset(CHAMPSdata, group=="Child")
IV5data.childu5 <- subset(CHAMPSdata, case_type_desc %in% c("Child (12 months to less than 60 Months)","Infant (28 days to less than 12 months)"))
dim(IV5data.childu5)
names.use <- names(CHAMPSdata)[(names(CHAMPSdata) %in% colnames(sample_test))]
IV5data.neonatal.subset <- IV5data.neonatal[, c(names.use)]
IV5data.childu5.subset <- IV5data.childu5[, c(names.use)]
COMSAonly <- setdiff(colnames(IV5data.neonatal.subset), colnames(sample_test))
sampleonly <- setdiff(colnames(sample_test),colnames(IV5data.neonatal.subset))
length(COMSAonly)
length(sampleonly)
# for (i in 1:length(sampleonly)){
#   IV5data.neonatal.subset[,sampleonly[i]]<-"."
#   IV5data.childu5.subset[,sampleonly[i]]<-"."
# }
IV5neonate <- setcolorder(IV5data.neonatal.subset, names(sample_test))
IV5childu5 <- setcolorder(IV5data.childu5.subset, names(sample_test))
################################## Run models for CHAMPS
# InterVA5
set.seed(123)
InterVA5.neonate <- InterVA5(IV5neonate, HIV = "h", Malaria = "h", write=FALSE,
directory = tempdir(), filename = "VA5_result", output = "extended", append = FALSE)
set.seed(123)
InterVA5.childu5 <- InterVA5(IV5childu5, HIV = "h", Malaria = "h", write=FALSE,
directory = tempdir(), filename = "VA5_result", output = "extended", append = FALSE)
# compare to codeVA - these don't run, in this case
# codeVAInterVA5.neonate <- codeVA(IV5neonate, data.type = "WHO2016", model = "InterVA",
#                                  directory = tempdir(), version = "5.0", HIV = "h", Malaria = "h")
# codeVAInterVA5.childu5 <- codeVA(IV5childu5, data.type = "WHO2016", model = "InterVA",
#                                  directory = tempdir(), version = "5.0", HIV = "h", Malaria = "h")
# Insilico
set.seed(123)
codeVAInsilico.neonate <- codeVA(IV5neonate, data.type = "WHO2016", model = "InSilicoVA",
Nsim=10000, version = "5.0", HIV = "h", Malaria = "h")
set.seed(123)
codeVAInsilico.childu5 <- codeVA(IV5childu5, data.type = "WHO2016", model = "InSilicoVA",
Nsim=10000, version = "5.0", HIV = "h", Malaria = "h")
save_file<-paste("/Users/EWilson/Desktop/Analysis/Data/20200123forCalibration-CHAMPS.Rdata", sep="")
save.image(file=save_file)
load("/Users/EWilson/Desktop/COMSA/Rdata/20200123forCalibration-CHAMPS.Rdata")
library(rJava)
library(openVA)
library(haven)
library(readr)
library(dplyr)
library(CrossVA)
library(readxl)
library(data.table)
# GET COD
InterVA4.COD.neonate <- data.frame(lapply(getTopCOD(InterVA4_neonate),as.character), stringsAsFactors = FALSE)
InterVA5.COD.neonate <- data.frame(lapply(getTopCOD(InterVA5.neonate),as.character), stringsAsFactors = FALSE)
InterVA5.COD.neonate
